<!DOCTYPE html>
<html><head>
	<meta name="generator" content="Hugo 0.74.3" />
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="A personal blog of z217">
    <meta name="Author" content="z217">
    <meta name="keywords" content="hugo blog">
    <link rel="stylesheet" href=https://z217.github.com/css/syntax.css>
    <link rel="stylesheet" href=https://z217.github.com/css/style.css>
    <script src="https://kit.fontawesome.com/1b7478c139.js" crossorigin="anonymous"></script>
    <title>z217&#39;s blog</title>
  </head><body><aside id="sidenav">
    <header>
    
        <a href=https://z217.github.com><img src="https://z217.github.com/avatar.png" alt="avatar"></a>
        
    

    <a id="branding" href=https://z217.github.com>
        
            z217&#39;s blog
        
    </a>
    </header>

    <nav>
        
            		
            <a href="/"
                
            >
                <i class="fas fa-home fa-ms"></i>
                <span>首页</span>
            </a>
        
            		
            <a href="/post/"
                
            >
                <i class="fas fa-keyboard fa-ms"></i>
                <span>文章</span>
            </a>
        
            		
            <a href="/tags"
                
            >
                <i class="fas fa-tags fa-ms"></i>
                <span>标签</span>
            </a>
        
            		
            <a href="/about"
                
            >
                <i class="fas fa-smile fa-ms"></i>
                <span>关于</span>
            </a>
        
            		
            <a href="https://github.com/z217"
                
                    target="_blank"
                
            >
                <i class="fab fa-github fa-ms"></i>
                <span>Github</span>
            </a>
        
            		
            <a href="/index.xml"
                
            >
                <i class="fas fa-rss fa-ms"></i>
                <span>RSS</span>
            </a>
        
    </nav>
</aside>
<main id="main">
            <a href="javascript:void(0)" id="closebtn" onclick="navToggle()"><i class="fas fa-bars fa-lg"></i></a>
            <div class="content">
    
        
    
    
    <div class="section"> 
        <div class="section-title">recent</div> 
        
        
            <div class="list-item">
                <a class="entry-title" href="/post/geohash%E7%AE%97%E6%B3%95%E7%AE%80%E4%BB%8B/">Geohash算法简介</a>
                
                
                <p>Geohash算法的简单解析以及在Redis中的使用</p>
                
                <div class="meta">
                
                    <i class="far fa-calendar-alt"></i> Aug 5 2020
                
                <br>
                
                        <i class="fas fa-tags"></i> 
                        Tags: Algorithm
                
                </div>
            </div>
        
            <div class="list-item">
                <a class="entry-title" href="/post/git%E5%B8%B8%E7%94%A8%E6%8C%87%E4%BB%A4%E6%B1%87%E6%80%BB/">Git常用指令汇总</a>
                
                
                <p>Git 一些常用指令的简单汇总</p>
                
                <div class="meta">
                
                    <i class="far fa-calendar-alt"></i> Aug 4 2020
                
                <br>
                
                        <i class="fas fa-tags"></i> 
                        Tags: Other
                
                </div>
            </div>
        
            <div class="list-item">
                <a class="entry-title" href="/post/jwt%E7%AE%80%E4%BB%8B/">JWT简介</a>
                
                
                <p>JWT简单介绍</p>
                
                <div class="meta">
                
                    <i class="far fa-calendar-alt"></i> Aug 4 2020
                
                <br>
                
                        <i class="fas fa-tags"></i> 
                        Tags: Other
                
                </div>
            </div>
        
        </div>
    

    
    <div class="section"> 
        <div class="section-title">μblog</div> 
        <div class="posts">
             
            
                <div class="post">
                    
                    <div class="post-content">
                        <h2 id="1-geohash算法介绍">1. <code>Geohash</code>算法介绍</h2>

<p><a href="https://en.wikipedia.org/wiki/Geohash">Geohash-Wikipedia</a></p>

<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<code>Geohash</code>是一种用于公共领域的地理编码系统，其将地理位置编码为字母和数字的短字符串。<code>Geohash</code>允许任意精度的属性，可以通过增长或缩短字符串来改变精度。当两个区域的公共前缀越长，说明他们的联系更加紧密。但是反过来，具有短公共前缀或者没有公共前缀并不一定代表着联系很小。<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<code>Geohash</code>算法可以将一个二维的经纬度坐标转换成一个可以比较的字符串，也就是降维。使用三十二进制，全球被划分为 <span  class="math">\(32\)</span> 个大块，再在每个大块内继续划分出 <span  class="math">\(32\)</span>个小块，因此对于越长的<code>geohash</code>字符串，其精度越大，代表的范围也就越小。通过<code>Base32</code>算法，<code>geohash</code>使用字母和数字表示值，如下所示：</p>

<table>
<thead>
<tr>
<th align="center">数字</th>
<th align="center">0</th>
<th align="center">1</th>
<th align="center">2</th>
<th align="center">3</th>
<th align="center">4</th>
<th align="center">5</th>
<th align="center">6</th>
<th align="center">7</th>
<th align="center">8</th>
<th align="center">9</th>
<th align="center">10</th>
<th align="center">11</th>
<th align="center">12</th>
<th align="center">13</th>
<th align="center">14</th>
<th align="center">15</th>
<th align="center">16</th>
<th align="center">17</th>
<th align="center">18</th>
<th align="center">19</th>
<th align="center">20</th>
<th align="center">21</th>
<th align="center">22</th>
<th align="center">23</th>
<th align="center">24</th>
<th align="center">25</th>
<th align="center">26</th>
<th align="center">27</th>
<th align="center">28</th>
<th align="center">29</th>
<th align="center">30</th>
<th align="center">31</th>
</tr>
</thead>

<tbody>
<tr>
<td align="center">32进制</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">2</td>
<td align="center">3</td>
<td align="center">4</td>
<td align="center">5</td>
<td align="center">6</td>
<td align="center">7</td>
<td align="center">8</td>
<td align="center">9</td>
<td align="center">b</td>
<td align="center">c</td>
<td align="center">d</td>
<td align="center">e</td>
<td align="center">f</td>
<td align="center">g</td>
<td align="center">h</td>
<td align="center">j</td>
<td align="center">k</td>
<td align="center">m</td>
<td align="center">n</td>
<td align="center">p</td>
<td align="center">q</td>
<td align="center">r</td>
<td align="center">s</td>
<td align="center">t</td>
<td align="center">u</td>
<td align="center">v</td>
<td align="center">w</td>
<td align="center">x</td>
<td align="center">y</td>
<td align="center">z</td>
</tr>
</tbody>
</table>

<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;即使用了所有 <span  class="math">\(10\)</span> 以内的数字，以及除 <span  class="math">\(a\)</span>, <span  class="math">\(i\)</span>, <span  class="math">\(l\)</span> 和 <span  class="math">\(o\)</span> 之外的所有小写字母。在计算的时候只需要在十进制和三十二进制之间转换即可，举例：</p>

<div>
$$\begin{aligned}
(ezs42)_{32} &= e \times 32^4 + z \times 32^3 + s \times 32^2 + 4 \times 32^1 + 2 \times 32^0 \\
&= 13 \times 1048576 + 31 \times 32768 + 24 \times 1024 + 4 \times 32 + 2 \times 1 \\
&= 14672002.
\end{aligned}$$
</div>

<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;正如之前所说的，<code>geohash</code>算法将经纬度转换成一个字符串，自然也能由字符串转回经纬度。再以 <span  class="math">\(ezs42\)</span> 为例，将其转换为二进制：</p>

<div>
$$\begin{aligned}
    &(e)_{32} = (01101)_2, \\
    &(z)_{32} = (11111)_2, \\
    &(s)_{32} = (11000)_2, \\
    &(4)_{32} = (00100)_2, \\
    &(2)_{32} = (00010)_2.
\end{aligned}$$
</div>

<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;结果得到的二进制数字为：<span  class="math">\((0110111111110000010000010)_2\)</span> 。假设从左到右读，则奇数位代表纬度代码：<span  class="math">\((101111001001)_2\)</span>，偶数位代表经度代码：<span  class="math">\((0111110000000)_2\)</span>。<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;接下来再通过二分法对经纬度代码进行分别处理。纬度的范围为 <span  class="math">\(-90 \sim 90\)</span> ，我们将其划分为两块：<span  class="math">\(-90 \sim 0\)</span> 和 <span  class="math">\(0 \sim 90\)</span> 。查看纬度代码，第一位为 <span  class="math">\(1\)</span>，因此选择 <span  class="math">\(0 \sim 90\)</span>。如果为 <span  class="math">\(0\)</span> 的话，就要选择左边的区间。即为 <span  class="math">\(0\)</span> 选择左边，为 <span  class="math">\(1\)</span> 选择右边。如果没有更多的位数，那么可以认为纬度为 <span  class="math">\(45\)</span>，这样误差范围就为 <span  class="math">\(\pm45\)</span> 。但是在这里我们有更多的位数，因此可以继续下去。再对 <span  class="math">\(0 \sim 90\)</span> 进行二分分为 <span  class="math">\(0 \sim 45\)</span> 和 <span  class="math">\(45 \sim 90\)</span> ，可以看到纬度代码第二位为 <span  class="math">\(0\)</span> ，因此选择 <span  class="math">\(0 \sim 45\)</span> 。如此往复，可以确认纬度值。再使用同样的方法，可以确认经度值，不过要注意经度的范围是 <span  class="math">\(-180 \sim 180\)</span> 。<br>
经度确定：</p>

<table>
<thead>
<tr>
<th align="center">位数</th>
<th align="center">位值</th>
<th align="center">最小值</th>
<th align="center">中间值</th>
<th align="center">最大值</th>
</tr>
</thead>

<tbody>
<tr>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">-90.000</td>
<td align="center">0.000</td>
<td align="center">90.000</td>
</tr>

<tr>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0.000</td>
<td align="center">45.000</td>
<td align="center">90.000</td>
</tr>

<tr>
<td align="center">2</td>
<td align="center">1</td>
<td align="center">0.000</td>
<td align="center">22.500</td>
<td align="center">45.000</td>
</tr>

<tr>
<td align="center">3</td>
<td align="center">1</td>
<td align="center">22.500</td>
<td align="center">33.750</td>
<td align="center">45.000</td>
</tr>

<tr>
<td align="center">4</td>
<td align="center">1</td>
<td align="center">33.750</td>
<td align="center">39.375</td>
<td align="center">45.000</td>
</tr>

<tr>
<td align="center">5</td>
<td align="center">1</td>
<td align="center">39.375</td>
<td align="center">42.188</td>
<td align="center">45.000</td>
</tr>

<tr>
<td align="center">6</td>
<td align="center">0</td>
<td align="center">42.188</td>
<td align="center">43.594</td>
<td align="center">45.000</td>
</tr>

<tr>
<td align="center">7</td>
<td align="center">0</td>
<td align="center">42.188</td>
<td align="center">42.891</td>
<td align="center">43.594</td>
</tr>

<tr>
<td align="center">8</td>
<td align="center">1</td>
<td align="center">42.188</td>
<td align="center">42.539</td>
<td align="center">42.891</td>
</tr>

<tr>
<td align="center">9</td>
<td align="center">0</td>
<td align="center">42.539</td>
<td align="center">42.715</td>
<td align="center">42.891</td>
</tr>

<tr>
<td align="center">10</td>
<td align="center">0</td>
<td align="center">42.539</td>
<td align="center">42.627</td>
<td align="center">42.715</td>
</tr>

<tr>
<td align="center">11</td>
<td align="center">1</td>
<td align="center">42.539</td>
<td align="center">42.583</td>
<td align="center">42.627</td>
</tr>
</tbody>
</table>

<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;可得纬度为 <span  class="math">\(42.583\)</span> ，同理可得经度为 <span  class="math">\(-5.581\)</span> ，经纬度误差范围都在 <span  class="math">\(\pm0.022\)</span> 之间。根据经纬度与千米的比例表可得误差距离。</p>

<table>
<thead>
<tr>
<th align="left"><code>Geohash</code>长度</th>
<th align="left">纬度位数</th>
<th align="left">经度位数</th>
<th align="left">纬度误差</th>
<th align="left">经度误差</th>
<th align="left">千米误差</th>
</tr>
</thead>

<tbody>
<tr>
<td align="left">1</td>
<td align="left">2</td>
<td align="left">3</td>
<td align="left"><span  class="math">\(\pm23\)</span></td>
<td align="left"><span  class="math">\(\pm23\)</span></td>
<td align="left"><span  class="math">\(\pm2500\)</span></td>
</tr>

<tr>
<td align="left">2</td>
<td align="left">5</td>
<td align="left">5</td>
<td align="left"><span  class="math">\(\pm2.8\)</span></td>
<td align="left"><span  class="math">\(\pm5.6\)</span></td>
<td align="left"><span  class="math">\(\pm630\)</span></td>
</tr>

<tr>
<td align="left">3</td>
<td align="left">7</td>
<td align="left">8</td>
<td align="left"><span  class="math">\(\pm0.70\)</span></td>
<td align="left"><span  class="math">\(\pm0.70\)</span></td>
<td align="left"><span  class="math">\(\pm78\)</span></td>
</tr>

<tr>
<td align="left">4</td>
<td align="left">10</td>
<td align="left">10</td>
<td align="left"><span  class="math">\(\pm0.087\)</span></td>
<td align="left"><span  class="math">\(\pm0.18\)</span></td>
<td align="left"><span  class="math">\(\pm20\)</span></td>
</tr>

<tr>
<td align="left">5</td>
<td align="left">12</td>
<td align="left">13</td>
<td align="left"><span  class="math">\(\pm0.022\)</span></td>
<td align="left"><span  class="math">\(\pm0.022\)</span></td>
<td align="left"><span  class="math">\(\pm2.4\)</span></td>
</tr>

<tr>
<td align="left">6</td>
<td align="left">15</td>
<td align="left">15</td>
<td align="left"><span  class="math">\(\pm0.0027\)</span></td>
<td align="left"><span  class="math">\(\pm0.0055\)</span></td>
<td align="left"><span  class="math">\(\pm0.61\)</span></td>
</tr>

<tr>
<td align="left">7</td>
<td align="left">17</td>
<td align="left">18</td>
<td align="left"><span  class="math">\(\pm0.00068\)</span></td>
<td align="left"><span  class="math">\(\pm0.00068\)</span></td>
<td align="left"><span  class="math">\(\pm0.076\)</span></td>
</tr>

<tr>
<td align="left">8</td>
<td align="left">20</td>
<td align="left">20</td>
<td align="left"><span  class="math">\(\pm0.000085\)</span></td>
<td align="left"><span  class="math">\(\pm0.00017\)</span></td>
<td align="left"><span  class="math">\(\pm0.019\)</span></td>
</tr>
</tbody>
</table>

<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;对于一个给定的经纬度，要想求得经纬度的二进制代码值，只需要将上述步骤倒过来即可。再以 <span  class="math">\((42.583, -5.581)\)</span> 为例。<br>
经度代码确定：</p>

<table>
<thead>
<tr>
<th align="center">位数</th>
<th align="center">最小值</th>
<th align="center">中间值</th>
<th align="center">最大值</th>
<th align="center">位值</th>
</tr>
</thead>

<tbody>
<tr>
<td align="center">0</td>
<td align="center">-90.000</td>
<td align="center">0.000</td>
<td align="center">90.000</td>
<td align="center">1</td>
</tr>

<tr>
<td align="center">1</td>
<td align="center">0.000</td>
<td align="center">45.000</td>
<td align="center">90.000</td>
<td align="center">0</td>
</tr>

<tr>
<td align="center">2</td>
<td align="center">0.000</td>
<td align="center">22.500</td>
<td align="center">45.000</td>
<td align="center">1</td>
</tr>

<tr>
<td align="center">3</td>
<td align="center">22.500</td>
<td align="center">33.750</td>
<td align="center">45.000</td>
<td align="center">1</td>
</tr>

<tr>
<td align="center">4</td>
<td align="center">33.750</td>
<td align="center">39.375</td>
<td align="center">45.000</td>
<td align="center">1</td>
</tr>

<tr>
<td align="center">5</td>
<td align="center">39.375</td>
<td align="center">42.188</td>
<td align="center">45.000</td>
<td align="center">1</td>
</tr>

<tr>
<td align="center">6</td>
<td align="center">42.188</td>
<td align="center">43.594</td>
<td align="center">45.000</td>
<td align="center">0</td>
</tr>

<tr>
<td align="center">7</td>
<td align="center">42.188</td>
<td align="center">42.891</td>
<td align="center">43.594</td>
<td align="center">0</td>
</tr>

<tr>
<td align="center">8</td>
<td align="center">42.188</td>
<td align="center">42.539</td>
<td align="center">42.891</td>
<td align="center">1</td>
</tr>

<tr>
<td align="center">9</td>
<td align="center">42.539</td>
<td align="center">42.715</td>
<td align="center">42.891</td>
<td align="center">0</td>
</tr>

<tr>
<td align="center">10</td>
<td align="center">42.539</td>
<td align="center">42.627</td>
<td align="center">42.715</td>
<td align="center">0</td>
</tr>
</tbody>
</table>

<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;虽然通过<code>geohash</code>可以通过公共前缀来查找一些彼此相邻的点，但是在一些边缘情况无法通过这种方式进行查询。例如在本初子午线左右两端的<code>geohash</code>值并没有公共前缀，以及靠近南北极的区域的<code>geohash</code>值差异很大。因为<code>geohash</code>依赖经纬度得到数值，因此在这些经纬度变化迅速的区域，它们的<code>geohash</code>值的变化也很迅速。</p>

<h2 id="2-redis中使用geo数据类型">2. <code>Redis</code>中使用<code>geo</code>数据类型</h2>

<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;继续以 <span  class="math">\((42.583, -5.581)\)</span> 为例，演示在<code>Redis</code>中操作<code>geo</code>数据类型。</p>
<pre><code class="language-redis" data-lang="redis">geoadd location -5.581 42.583 gw01</code></pre>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;将 <span  class="math">\((42.583, -5.581)\)</span> 存入 <span  class="math">\(location\)</span> 并命名为 <span  class="math">\(gw01\)</span>。<span  class="math">\(location\)</span> 本质为 <span  class="math">\(zset\)</span> 数据类型。再对其获取得</p>
<pre><code class="language-redis" data-lang="redis">geopos location gw01</code></pre>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;计算其<code>geohash</code>值</p>
<pre><code class="language-redis" data-lang="redis">geohash location gw01</code></pre>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;此外，通过</p>
<pre><code class="language-redis" data-lang="redis">geodist
georadius
georadiusbymember</code></pre>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;这些指令可以计算范围内符合条件的坐标。</p>

                    </div>
                    <div class="meta post-footer"> <span>Aug 5 2020 07:58 UTC&#43;08</span> <a href="/post/geohash%E7%AE%97%E6%B3%95%E7%AE%80%E4%BB%8B/"><i class="fas fa-link"></i> link</a></div> 
                </div>
            
                <div class="post">
                    
                    <div class="post-content">
                        <h2 id="创建仓库init">创建仓库/init</h2>
<pre><code class="language-git" data-lang="git">git init</code></pre>
<p>创建成功后当前目录下会生成一个<code>.git</code>目录，用于跟踪和管理版本库。</p>

<h2 id="添加文件add">添加文件/add</h2>
<pre><code class="language-git" data-lang="git">git add</code></pre>
<p><code>.</code> 自动添加本地所有修改。</p>

<h2 id="提交commit">提交/commit</h2>
<pre><code class="language-git" data-lang="git">git commit</code></pre>
<p><span  class="math">\(-m\)</span> 增加提交信息。<br>
<span  class="math">\(-a\)</span> 自动寻找修改的文件并提交。</p>

<h2 id="状态查看status">状态查看/status</h2>
<pre><code class="language-git" data-lang="git">git status</code></pre>
<p><span  class="math">\(-s\)</span> 简短输出。</p>

<h2 id="改动查看diffblame">改动查看/diff&amp;blame</h2>
<pre><code class="language-git" data-lang="git">git diff</code></pre>
<p><span  class="math">\(--cached\)</span> 显示暂存区的改动。<br>
<span  class="math">\(HEAD\)</span> 查看所有改动。<br>
<span  class="math">\(--stat\)</span> 显示摘要。</p>
<pre><code class="language-git" data-lang="git">git blame</code></pre>
<p>文件修改记录。</p>

<h2 id="历史查看log">历史查看/log</h2>
<pre><code class="language-git" data-lang="git">git log</code></pre>
<p>按时间由近到远排序，列出最近的三次提交。<br>
<span  class="math">\(-p\;[filename]\)</span> 文件最后一次提交信息。<br>
<span  class="math">\(--pretty=oneline\)</span> 可以列出简略的信息。<br>
<span  class="math">\(--graph\)</span> 拓扑图显示。<br>
<span  class="math">\(--reverse\)</span> 逆向显示。<br>
<span  class="math">\(--author=\)</span> 查找指定作者。<br>
<span  class="math">\(--since\)</span>, <span  class="math">\(--before\)</span>, <span  class="math">\(--util\)</span>, <span  class="math">\(--after\)</span> 指定日期。<br>
<span  class="math">\(--decorate\)</span> 显示标签。</p>

<h2 id="提交撤销revert">提交撤销/revert</h2>
<pre><code class="language-git" data-lang="git">git revert</code></pre>
<h2 id="回退版本reset">回退版本/reset</h2>
<pre><code class="language-git" data-lang="git">git reset --hard HEAD^
git reset --hard HEAD~2
git reset --hard 56e7</code></pre>
<p><span  class="math">\(HEAD\)</span> 表示当前版本。<code>^</code> 表示回退一个版本，可以输入多个 <code>^</code>。<span  class="math">\(\sim\)</span> 之后可以输入任意数字，表示回退对应数量的版本。也可以直接输入版本号，版本号通过 <span  class="math">\(git\;log\)</span> 命令查询，使用版本号不仅可以回退版本，在错误回退版本之后，也可以前进到指定的版本，版本号可以不写全，但一定要写到<code>Git</code>能识别出唯一一个版本为止。</p>
<pre><code class="language-git" data-lang="git">git reset HEAD [filename]</code></pre>
<p>撤销暂存区的改动。</p>
<pre><code class="language-git" data-lang="git">git reset --keep</code></pre>
<p>回退并保存未提交的改动。</p>

<h2 id="指令记录查询reflog">指令记录查询/reflog</h2>
<pre><code class="language-git" data-lang="git">git reflog</code></pre>
<p>此指令会列出曾经执行过的指令，也会显示版本号。</p>

<h2 id="文件删除rm">文件删除/rm</h2>
<pre><code class="language-git" data-lang="git">git rm</code></pre>
<p><span  class="math">\(-f\)</span> 删除之前修改且放到暂存区的文件。<br>
<span  class="math">\(--cached\)</span> 只删除在暂存区的文件。<br>
<span  class="math">\(-r\)</span> 递归删除子目录和文件。</p>

<h2 id="文件移动mv">文件移动/mv</h2>
<pre><code class="language-git" data-lang="git">git mv</code></pre>
<p>也可以用于重命名文件。</p>

<h2 id="文件拷贝clone">文件拷贝/clone</h2>
<pre><code class="language-git" data-lang="git">git clone</code></pre>
<h2 id="分支切换checkoutswitch">分支切换/checkout&amp;switch</h2>
<pre><code class="language-git" data-lang="git">git checkout</code></pre>
<p><span  class="math">\(--\;\;[filename]\)</span> 丢弃工作区指定文件的改动（不切换分支）。<br>
<span  class="math">\(-b\)</span> 创建新分支并立即切换到该分支。</p>
<pre><code class="language-git" data-lang="git">git switch</code></pre>
<p><span  class="math">\(-c\)</span> 创建并切换到新的分支。</p>

<h2 id="分支管理branch">分支管理/branch</h2>
<pre><code class="language-git" data-lang="git">git branch</code></pre>
<p>不加分支名可以列出分支。<br>
<span  class="math">\(-d\)</span> 删除分支。<br>
<span  class="math">\(-D\)</span> 强制删除分支。<br>
<span  class="math">\( --set-upstream-to=[origin/branch]\;\;[local branch] \)</span> 关联本地分支与远程库分支。<br>
<span  class="math">\(--track\)</span> 基于远程分支创建新分支。<br>
<span  class="math">\([origin]\;\;--delete\;\;[branch]\)</span> 删除远程分支。</p>

<h2 id="合并分支mergemergetool">合并分支/merge&amp;mergetool</h2>
<pre><code class="language-git" data-lang="git">git merge</code></pre>
<p><span  class="math">\(--no-ff\)</span> 分支时提交（即保留分支信息）。</p>
<pre><code class="language-git" data-lang="git">git mergetool</code></pre>
<p>使用配置的合并工具解决冲突。</p>

<h2 id="远程库remote">远程库/remote</h2>
<pre><code class="language-git" data-lang="git">git remote</code></pre>
<p>查看远程库信息。<br>
<span  class="math">\(-v\)</span> 查看详细信息。</p>
<pre><code class="language-git" data-lang="git">git remote add [remote] [url]</code></pre>
<p>创建远程库，远程库名字默认为<span  class="math">\(origin\)</span>。</p>
<pre><code class="language-git" data-lang="git">git remote rename</code></pre>
<p>重命名远程库。</p>

<h2 id="远程库推送push">远程库推送/push</h2>
<pre><code class="language-git" data-lang="git">git push [remote] [local branch]</code></pre>
<p>也可以将本地分支名改为标签名，或改为 <span  class="math">\(--tags\)</span> 推送所有未推送的标签， <span  class="math">\(:refs/tags/[tag name]\)</span> 删除指定标签。<br>
<span  class="math">\(-u\)</span> 关联对应库和本地分支，简化后续操作。<br>
<span  class="math">\(-[remote]:[old name]\)</span> 重命名远程分支。</p>

<h2 id="提交抓取pullfetch">提交抓取/pull&amp;fetch</h2>
<pre><code class="language-git" data-lang="git">git pull [remote] [branch]
git fetch [remote]</code></pre>
<p>下载新数据与分支。</p>

<h2 id="工作区储存stash">工作区储存/stash</h2>
<pre><code class="language-git" data-lang="git">git stash
git stash list
git stash apply
git stash drop
git stash pop</code></pre>
<p>分别用于储存、列出、恢复、删除储存内容，<span  class="math">\(pop\)</span> 会在恢复同时删除储存内容。</p>

<h2 id="改动复制cherrypick">改动复制/cherry-pick</h2>
<pre><code class="language-git" data-lang="git">git cherry-pick</code></pre>
<p>将对应的提交改动复制到另一个分支。</p>

<h2 id="变基rebase">变基/rebase</h2>
<pre><code class="language-git" data-lang="git">git rebase</code></pre>
<p><span  class="math">\(--abort\)</span> 终止合并。<br>
<span  class="math">\(--continue\)</span> 继续合并。</p>

<h2 id="标签创建tag">标签创建/tag</h2>
<pre><code class="language-git" data-lang="git">git tag
git tag [tag name] [commit id]</code></pre>
<p>未指定标签名时列出所有标签，不指定版本号时默认为当前版本。
<span  class="math">\(-a\)</span> 为标签添加注解。
<span  class="math">\(-d\)</span> 删除指定标签。</p>

<h2 id="信息显示show">信息显示/show</h2>
<pre><code class="language-git" data-lang="git">git show</code></pre>
<p><span  class="math">\([tag name]\)</span> 查看标签信息。</p>
<pre><code class="language-git" data-lang="git">git remote show</code></pre>
<p><span  class="math">\([remote]\)</span> 查看远程库信息。</p>

                    </div>
                    <div class="meta post-footer"> <span>Aug 4 2020 07:36 UTC&#43;00</span> <a href="/post/git%E5%B8%B8%E7%94%A8%E6%8C%87%E4%BB%A4%E6%B1%87%E6%80%BB/"><i class="fas fa-link"></i> link</a></div> 
                </div>
            
                <div class="post">
                    
                    <div class="post-content">
                        <p><a href="https://en.wikipedia.org/wiki/JSON_Web_Token">JWT-Wikipedia</a></p>

<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<code>JWT</code>( <span  class="math">\(JSON\;Web\;Token\)</span> )是一种基于<code>JSON</code>的用于创建可选签名或可选加密的数据的互联网标准。<code>Token</code>使用一个私钥或者公钥进行签名，持有私钥或者公钥的一方可以验证令牌的合法性。<code>Token</code>被设计为紧凑且安全的，尤其适用于<code>Web</code>浏览器单点登录 ( <code>Single-sign-on</code>, <span  class="math">\(SSO\)</span> ) 场景。<code>JWT</code>声明一般用于在身份提供者和服务提供者之间传递用户身份信息，或者用于业务流程要求的任何其他类型的声明。</p>

<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;在传统的<code>session</code>认证中，通常使用<code>cookie</code>来保存用户的身份信息，方便下一次请求。由于<code>session</code>是存储在内存中的，因此存在开销隐患。而且使用<code>cookie</code>也意味着存在着<code>CSRF</code>问题。使用<code>JWT</code>进行认证时，用户在成功认证登录过后，将会得到一个<code>token</code>。<code>Token</code>会保存在本地（也可以保存在<code>session</code>或者<code>cookie</code>中），而不是传统的在服务器上创建一个<code>session</code>并返回<code>cookie</code>。每当用户想要访问受保护的资源时，用户代理需要发送<code>JWT</code>，<code>JWT</code>通常包含在请求头中。通过使用<code>JWT</code>，用户的状态永远也不会保存在服务器中。当接收到请求时，服务器将会检查<code>JWT</code>的有效性。由于<code>JWT</code>是独立的，存储着所有必要的信息，因此可以减少数据库查询的次数。</p>

<h2 id="jwt的结构"><code>JWT</code>的结构</h2>

<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<code>JWT</code>由三部分组成：<span  class="math">\(Header\)</span>, <span  class="math">\(Payload\)</span>, <span  class="math">\(Signature\)</span> 。</p>

<h3 id="1-header">1. Header</h3>
<div class="highlight"><pre class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span>
    <span class="nt">&#34;alg&#34;</span><span class="p">:</span> <span class="s2">&#34;HS256&#34;</span><span class="p">,</span>
    <span class="nt">&#34;typ&#34;</span><span class="p">:</span> <span class="s2">&#34;JWT&#34;</span>
<span class="p">}</span></code></pre></div>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span  class="math">\(Header\)</span> 标识用于生成签名的算法。典型的加密算法如<code>HMAC-SHA-256</code>, <code>RSA-SHA-256</code>。上例使用的是<code>HMAC-SHA-256</code>。</p>

<h3 id="2-payload">2. Payload</h3>
<div class="highlight"><pre class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span>
    <span class="nt">&#34;loggedInAs&#34;</span><span class="p">:</span> <span class="s2">&#34;admin&#34;</span><span class="p">,</span>
    <span class="nt">&#34;iat&#34;</span><span class="p">:</span> <span class="mi">1422779638</span>
<span class="p">}</span></code></pre></div>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$Payload$ 包含了一组声明。<code>JWT</code>标准注册了七个声明：</p>

<ul>
<li><span  class="math">\(iss\)</span>：<code>JWT</code>签发者</li>
<li><span  class="math">\(sub\)</span>：<code>JWT</code>面向用户</li>
<li><span  class="math">\(aud\)</span>：<code>JWT</code>接收方</li>
<li><span  class="math">\(exp\)</span>：<code>JWT</code>过期时间</li>
<li><span  class="math">\(nbf\)</span>：<code>JWT</code>启用时间</li>
<li><span  class="math">\(iat\)</span>：<code>JWT</code>签发时间</li>
<li><span  class="math">\(jti\)</span>：<code>JWT</code>的唯一身份标识，可以用作一次性<code>token</code></li>
</ul>

<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$Payload$ 中还可以添加自定义声明，如上例的 <span  class="math">\(loggedInAs\)</span>。</p>

<h3 id="3-signature">3. Signature</h3>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">signature</span> <span class="o">=</span> <span class="nx">HMAC</span><span class="o">-</span><span class="nx">SHA256</span><span class="p">(</span>
    <span class="nx">base64urlEncoding</span><span class="p">(</span><span class="nx">header</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="nx">base64urlEncoding</span><span class="p">(</span><span class="nx">payload</span><span class="p">),</span>
    <span class="s1">&#39;secret&#39;</span>
<span class="p">);</span>
</code></pre></div>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span  class="math">\(Signature\)</span> 用于安全地验证<code>token</code>。使用 <span  class="math">\(Base64urlEncoding\)</span> 对 <span  class="math">\(header\)</span> 和 <span  class="math">\(payload\)</span> 进行编码，再使用句点隔开，可以计算出签名。<span  class="math">\(secret\)</span>保存在服务器中，在使用指定算法生成签名的时候使用，生成哈希，确保数据不被篡改。然后再通过指定的算法，在此例中为 <code>HMAC-SHA256</code>， 进行加密。<span  class="math">\(Base64url\)</span> 编码类似于 <code>base64</code>。</p>

<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;最终得到的<code>JWT</code>如下</p>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="kr">const</span> <span class="nx">token</span> <span class="o">=</span> <span class="nx">base64urlEncoding</span><span class="p">(</span><span class="nx">header</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="nx">base64urlEncoding</span><span class="p">(</span><span class="nx">payload</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="nx">base64urlEncoding</span><span class="p">(</span><span class="nx">signature</span><span class="p">);</span>
</code></pre></div>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;最后在请求头中加入</p>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="nx">Authorization</span><span class="o">:</span> <span class="sb">`Bearer&#39; + token
</span></code></pre></div>
                    </div>
                    <div class="meta post-footer"> <span>Aug 4 2020 04:41 UTC&#43;08</span> <a href="/post/jwt%E7%AE%80%E4%BB%8B/"><i class="fas fa-link"></i> link</a></div> 
                </div>
             
        </div>
    </div>
    

            </div><footer>
    <div class="footer-content">
        
        <div class="contact-info">
            
            <div class="footer-mail">
                <i class="far fa-envelope"></i> <a href="mailto:mailto:zihan.zhouchn@outlook.com">mailto:zihan.zhouchn@outlook.com</a> </div>
            
            
        </div>
        
        
        <p class="copyright meta">Copyright © 2020–2020, z217 and the Hugo Authors; all rights reserved.</p>
        
    </div>
</footer>

<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_SVG"></script></main>
    </body>
    <script src=https://z217.github.com/js/navbutton.js></script>
</html>
